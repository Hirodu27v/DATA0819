Finding & Getting Data - Google Sheet's import HTML
このビデオでは、Google Sheetsを使って表を他のページからスプレッドシートに自動的にインポートするための便利な方法を紹介します。importHTMLと呼ばれます。
実演してみましょう。ガーディアン紙のサッカーのテーブルです。世界中のさまざまなサッカー選手権のテーブルがあります。
これらのテーブルを一括してGoogle Sheetsにインポートするには、すべてのテキストを選択してから、コピー&ペーストします。
importHTMLを使用して特定のテーブルまたは複数のテーブルをこのページから直接Google Sheetに自動的にインポートすることもできます。
まずやってみましょう。空白のセルに移動して「=importHTML (HTML形式)」と入力し、次に「(」と入力します。「importHTML (」には三つのパラメータが必要です。
最初はテーブルがあるWebページのURLです。二つ目はクエリと呼ばれており、テーブルかリストかを選択できます。
ここではテーブルを選択するので、HTMLテーブルでなくてはいけません。最後のパラメータは、Webページ上のテーブルの位置を指定します。
それではガーディアン紙のサッカーのテーブルがあるページに戻りましょう。たとえばラ・リーガ、スペインのプロリーグを表す２番目のテーブルをインポートします。
アドレスバーのURLを引用符を付けたうえでcontrol+Cかcommand+Cでコピー＆ペーストしてください。
引用符の後には区切り記号が必要ですが、Googleアカウントの言語設定によっては、この区切り記号が異なる可能性があります。これを見てください。
ここでは "," を入力して "table" と打ち込みます。 
最後に、Webページ上のテーブルの位置を指定します。ラ・リーガは２番目のテーブルですから、２と入力します。このとき、引用符は必要ありません。
括弧を閉じてエンターキーを押すとWebページの２番目の表が表示されます。３番目の表は「３」、１番目は「１」と変更するだけで、テーブルが自動的にロードされます。
最初のセルをコピーして７列目にペーストし、（テーブルの位置を示す数字を）２に変えます。
さて、これを削除して別の例をやってみましょう。これはインド映画の最高興行収入のリストです。これはWikipediaのページで、このページの中にも複数のテーブルがあります。
ページを見ると、インド映画の最高興行収入を並べたリストが最初のテーブルに見えますよね？
同じ手順で進めて、番号を「１」とし、何が起こるか見てみましょう。
最初のテーブルと同じように見えるものはロードできません。ImportHTMLは、ページのHTMLコードをインポートし、コード内の最初のテーブルをロードします。
どうしてうまくいかなかったのか見てみましょう。番号を２に変えると、求めている表がロードされます。
コード上は私たちが見ているテーブルの前に、別のテーブルがあります。テーブルらしくない構造なので、私たちにはテーブルに見えないのです。
「1」から「2」に番号を変更し、適切なテーブルをロードするだけです。importHTMLの動作速度を確認するために、さらに別の例を示します。

Those are all tables that are you know, small tables like 25 rows, 10 rows. What if we
wanted to load a table that has you know, hundreds of rows. Right. Let me let, me show
you an example. This is a web page that shows airport, airport codes in Europe. And see
that there are hundreds of airports here, all airports in Europe. And this is actually a table.
So what if we wanted to import this table automatically to importHTML? So we just copy
here the address "Copy", then you come back here, "importHTML" and then we put the
URL between quotes. Comma, "table", comma again, table between quotes. And then we
put the position of the table on the HTML code and then we hit enter. See how fast it
loads, we have actually more than over 200 airports in Europe and it loads very fast.
And the good thing about importHTML is that if I leave this table here as is, with the
importHTML function loaded, it'll actually update automatically the table here on the
Google Sheet if any changes happen on the website. So, if there's any update here or any
update here, or any update here my Google Sheet will be updated automatically as well
because importHTML access the website from time to time automatically to load the latest
results. Now, some considerations are important. ImportHTML will only import HTML
tables, so you need to check out the code to make sure that what you're importing is
actually a table. Right. So if we, for example, right click here and do some inspecting to
see the HTML code, we will see that there is actually a table tag here on the HTML code
that describes this table. Sometimes there are elements on a web page that looks like an
HTML table but they are not a table. They might be a Div, they might use a different tag to
represent what we see as a table but it's not actually an HTML table. So that's a caveat of
importHTML.
The other thing that we need to consider is that the importHTML will only return tables that
are visible to Google Sheets. Right. So because Google Sheets will try to access the
website, the answer that the website gives to Google Sheets needs to be the HTML code
that you see here on your browser. Sometimes some websites will prevent automated
access so Google Sheets is sort of an automated access to the website. So some Web
sites will block or prevent the full HTML code to be loaded. So, you might want to pay
attention to that too if you get mixed results. So there it is, this is importHTML and this is
how we import tables automatically to Google Sheets.
