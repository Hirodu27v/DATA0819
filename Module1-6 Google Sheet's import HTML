Finding & Getting Data - Google Sheet's import HTML
このビデオでは、Google Sheetsを使って表を他のページからスプレッドシートに自動的にインポートするための便利な方法を紹介します。importHTMLと呼ばれます。
実演してみましょう。ガーディアン紙のサッカーのテーブルです。世界中のさまざまなサッカー選手権のテーブルがあります。
これらのテーブルを一括してGoogle Sheetsにインポートするには、すべてのテキストを選択してから、コピー&ペーストします。
importHTMLを使用して特定のテーブルまたは複数のテーブルをこのページから直接Google Sheetに自動的にインポートすることもできます。
まずやってみましょう。空白のセルに移動して「=importHTML (HTML形式)」と入力し、次に「(」と入力します。「importHTML (」には三つのパラメータが必要です。
最初はテーブルがあるWebページのURLです。二つ目はクエリと呼ばれており、テーブルかリストかを選択できます。
ここではテーブルを選択するので、HTMLテーブルでなくてはいけません。最後のパラメータは、Webページ上のテーブルの位置を指定します。
それではガーディアン紙のサッカーのテーブルがあるページに戻りましょう。たとえばラ・リーガ、スペインのプロリーグを表す２番目のテーブルをインポートします。
アドレスバーのURLを引用符を付けたうえでcontrol+Cかcommand+Cでコピー＆ペーストしてください。
引用符の後には区切り記号が必要ですが、Googleアカウントの言語設定によっては、この区切り記号が異なる可能性があります。これを見てください。
ここでは "," を入力して "table" と打ち込みます。 
最後に、Webページ上のテーブルの位置を指定します。ラ・リーガは２番目のテーブルですから、２と入力します。このとき、引用符は必要ありません。
括弧を閉じてエンターキーを押すとWebページの２番目の表が表示されます。３番目の表は「３」、１番目は「１」と変更するだけで、テーブルが自動的にロードされます。
最初のセルをコピーして７列目にペーストし、（テーブルの位置を示す数字を）２に変えます。
さて、これを削除して別の例をやってみましょう。これはインド映画の最高興行収入のリストです。これはWikipediaのページで、このページの中にも複数のテーブルがあります。
ページを見ると、インド映画の最高興行収入を並べたリストが最初のテーブルに見えますよね？
同じ手順で進めて、番号を「１」とし、何が起こるか見てみましょう。
最初のテーブルと同じように見えるものはロードできません。ImportHTMLは、ページのHTMLコードをインポートし、コード内の最初のテーブルをロードします。
どうしてうまくいかなかったのか見てみましょう。番号を２に変えると、求めている表がロードされます。
コード上は私たちが見ているテーブルの前に、別のテーブルがあります。テーブルらしくない構造なので、私たちにはテーブルに見えないのです。
「1」から「2」に番号を変更し、適切なテーブルをロードするだけです。importHTMLの動作速度を確認するために、さらに別の例を示します。
ここまで見てきたのは25行とか10行の小さなテーブルでした。何百行ものテーブルをロードするときはどうでしょう。そうですね、例を挙げましょう。
これはヨーロッパの空港コードを表示するWebページです。ここには数百のヨーロッパ中の空港が並んでおり、テーブルになっています。
これを自動的にインポートしたらどうでしょう。URLを引用符で囲んで、","、"table",再び","、そしてテーブルの位置をHTMLコードに書き込みます。
何と速いことでしょう、もう200以上のヨーロッパの空港をロードできました。
加えてimportHTMLの良いところは、関数をロードしたままにしておいても、Webサイトで何らかの変更が行われた場合に、Google Sheetのテーブルが自動的に更新されることです。
importHTMLは自動的にウェブサイトにアクセスし、最新のものをロードします。
ただ、いくつか留意事項があります。importHTMLはHTMLテーブルだけをロードするので、コードを調べて、インポートしようとしているものが本当にテーブルなのか確認する必要があります。
例えば、ここを右クリックして次の項目を確認します。
HTMLコードを見ると、このテーブルを説明するtableタグがここにあることがわかります。
Webページ上に、HTMLテーブルのように見えてもテーブルではない要素があることもあります。
Divの場合もあれば、別のタグを使用してテーブルとして表示される場合もありますが、実際にはHTMLテーブルではありません。ご注意を。
もう一つ注意すべきなのは、importHTMLが返すのはGoogle Sheetsに表示可能なテーブルだけだということです。
そうですね。Google SheetsがWebサイトにアクセスしたとき、そのサイトからGoogle Sheetsへの返答は、ブラウザのここにあるHTMLコードでなければなりません。
サイトによっては自動アクセスができない場合がありますが、（importHTMLが書かれた）Google SheetsはWebサイトへ自動アクセスするようなものなのです。
一部のサイトでは丸ごとHTMLコードをロードするのをブロックまたは禁止しています。ですから、期待と異なる結果が出たときにはこの点にも注意が必要です。
これがimportHTMLで、このようにして自動的にテーブルをGoogle Sheetsにインポートするのです。
